/*! flask-ppm-tool 22-07-2015 */
!function(){angular.module("PPT",["app.attributes","app.comment","app.curate","app.filter","app.header","app.login","app.loginInjectorProvider","app.manage","app.modalConfirm","app.project","app.report","app.select","app.stateLocation","app.title"])}(),function(){"use strict";function a(a){a.otherwise("/select")}angular.module("PPT").config(a),a.$inject=["$urlRouterProvider"]}(),function(){"use strict";function a(a,b){}angular.module("PPT").controller("PPTCtrl",a),a.$inject=["$rootScope","$location"]}(),function(){"use strict";function a(a){function b(b,c,d,e,f){window.onbeforeunload=function(b){a.$broadcast("savestate")}}a.$on("$stateChangeStart",b)}angular.module("PPT").run(a),a.$inject=["$rootScope"]}(),function(){angular.module("app.attributes",["ui.router"])}(),function(){"use strict";function a(a,b,c){this.als=c,this.attributes=this.als.getAttributes}angular.module("app.attributes").controller("Attributes",a),a.$inject=["$scope","$state","attributesService"]}(),function(){"use strict";function a(a,b,c){function d(a){if("multipleSelect"==a.format||"dateRangeSelect"==a.format)_.isArray(a.value)?this[a.name]=_.map(a.value,function(a){return a.id}):this[a.name]=a.value.id,a.child&&(_.isArray(a.child.value)?this[a.child.name]=a.child.value:this[a.child.name]=a.child.value.id);else if("date"==a.format||_.contains(["commentAuthored","commentEdited"],a.name)){if(a.computed)return;a.value?this[a.name]=new Date(a.value).toString("yyyy-MM-ddTHH:mm:ss"):this[a.name]=null}else"child_for_"!=a.format.substring(0,"child_for_".length)&&(this[a.name]=a.value)}function e(a){_.contains(["disposition","comment"],a.table)||d(a)}function f(){_.each(z.allAttributes,function(a){delete a.errors})}function g(a){return z.allAttributes[a]}function h(){return z.allAttributes}function i(b,c){var e=new Object;return e.csrf_token=z.csrf_token,"undefined"!=typeof c&&_.each(c,function(a){"undefined"!=typeof a.value.id?e[a.name]=a.value.id:e[a.name]=a.value}),_.each(z.getProjectAttributes(b),d,e),"comment"==b&&(e.commentEditor=a.currentUser.id),e}function j(a,b){try{return _.sortBy(z.projectAttributes[a],"attributeID")}catch(c){}}function k(a){try{return z.rawAttributes[a]}catch(b){}}function l(a){return a.multi?_.filter(a.choices,function(b){return _.contains(a.value,b.id)}):"lines"==a.format?_.filter(a.choices,function(b){return _.contains(a.value,b)}):_.where(a.choices,{id:a.value})[0]}function m(a){return"undefined"!=typeof a.value&&null!=a.value&&""!=a.value&&a.value!=[]||"undefined"!=typeof a.value&&null!=a.value&&"undefined"!=typeof a.value.id&&null!=a.value.id&&""!=a.value&&a.value!=[]?!0:!1}function n(){return z.csrf_token}function o(a){return"project link here"}function p(a){if("$$hashKey"!=a.name){var b=z.allAttributes[a.name];b.value=a.value,a.printValue&&(b.printValue=a.printValue),"child_for_"!=b.format.substring(0,"child_for_".length)&&("date"==b.format&&a.value&&(b.value=new Date(Date.parse(a.value))),z.projectAttributes[this].push(b))}}function q(){_.each(["description","portfolio","project"],function(a){z.projectAttributes[a]=[],u(a,[])})}function r(){var a=angular.fromJson(sessionStorage.attributesService);a&&(z.allAttributes=a.allAttributes,z.currentState=a.currentState)}function s(){var a=new Object;a.allAttributes=z.allAttributes,a.currentState=z.currentState,sessionStorage.attributesService=angular.toJson(a)}function t(a){z.allAttributes=a.data;var b=_.filter(a.data,function(a){return a.child?!0:void 0});_.each(b,function(a){var b=a.child;z.allAttributes[b.name]=b})}function u(a,b){z.currentState.keys=[];var c=k(a),d=c;"undefined"==typeof d&&(d=[]);var e;if(_.each(b,function(a){d=_.filter(d,function(b){return"undefined"==typeof b[a.name].id&&b[a.name]==a.id||b[a.name].id==a.id?(z.currentState.keys.push(a),!0):void 0})}),d.length){e=d[0];var f=[];_.each(Object.keys(e),function(a){"printValue"!=_.last(a.split("."))&&f.push({name:a,value:e[a]})}),z.projectAttributes[a]=[],_.each(f,p,a);var g=_.filter(z.projectAttributes[a],function(a){return"child"in a?!0:void 0});return _.each(g,function(a){var b=a.child.name;a.child=z.allAttributes[b]}),s(),e}var h=_.where(z.allAttributes,{table:a});z.projectAttributes[a]=[],_.each(h,function(b){b.computed||(_.contains(["multipleSelect","dateRangeSelect"],b.format)?b.value=[]:b.value="",z.projectAttributes[a].push(b))}),s()}function v(){b.get("/getAllAttributes").then(z.setAllAttributes)}function w(a){"undefined"!=typeof a&&_.each(a,function(a){_.each(Object.keys(a),function(a){var b=z.getAttribute(a);b.server_errors=this[a]},a)})}function x(a,b){z.currentState=new Object,z.currentState.keys=[],z.currentState.projectID=a.data.projectID,z.csrf_token=a.data.csrf_token,z.errors=a.data.errors,z.clearAllErrors(),delete z.success,z.updateErrors(a.data.errors),"OK"==a.statusText&&_.each(a.data.formData,y),"undefined"!=typeof b&&("disposedInFY"in b||"disposedInQ"in b)?u("disposition",[{name:"disposedInFY",id:z.allAttributes.disposedInFY.value.id},{name:"disposedInQ",id:z.allAttributes.disposedInQ.value.id}]):"undefined"!=typeof b&&"commentID"in b&&u("comment",[{name:"commentID",id:z.allAttributes.commentID.value}])}function y(a){var b=new Object;b.tableName=a.tableName,_.isArray(a.attributes[0].attributes)?("undefined"==typeof z.rawAttributes&&(z.rawAttributes=new Object),z.rawAttributes[b.tableName]=[],_.each(a.attributes,function(a){if(a.attributes.length){var c=new Object;_.each(a.attributes,function(a){c[a.name]=a.value,"undefined"!=typeof a.printValue&&(c[a.name+".printValue"]=a.printValue)}),z.rawAttributes[b.tableName].push(c)}})):("undefined"==typeof z.projectAttributes&&(z.projectAttributes=new Object),z.projectAttributes[b.tableName]=[],_.each(a.attributes,p,b.tableName))}var z={addAttrToDataObj:d,addUniqueAttrToDataObj:e,clearAllErrors:f,getAttribute:g,getAllAttributes:h,getFormData:i,getProjectAttributes:j,getRawAttributes:k,getSelectedChoices:l,getToken:n,hasAValue:m,makeProjectLink:o,mergeAttributeWithValue:p,newProjectAttributes:q,RestoreState:r,SaveState:s,setAllAttributes:t,updateProjAttrsFromRawItem:u,updateAllAttributes:v,updateErrors:w,updateProjectAttributes:x,updateProjectAttributesFromForm:y};return z.RestoreState(),"undefined"==typeof z.allAttributes&&z.updateAllAttributes(),a.$on("savestate",z.SaveState),a.$on("restorestate",z.RestoreState),z}angular.module("app.attributes").factory("attributesService",a),a.$inject=["$rootScope","$http","projectListService"]}(),function(){angular.module("app.comment",["ui.router"])}(),function(){"use strict";function a(a){a.state("comment",{url:"/comment",templateUrl:"/static/comment/comment.html",controller:"Comment",controllerAs:"comment",data:{requiresLogin:!0}})}angular.module("app.comment").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b){this.currentUser=b.currentUser}angular.module("app.comment").controller("Comment",a),a.$inject=["$scope","$rootScope"]}(),function(){angular.module("app.curate",["ui.router"])}(),function(){"use strict";function a(a){a.state("curate",{url:"/curate",templateUrl:"/static/curate/curate.html",controller:"Curate",controllerAs:"curate",data:{requiresLogin:!0}})}angular.module("app.curate").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b){this.currentUser=b.currentUser}angular.module("app.curate").controller("Curate",a),a.$inject=["$scope","$rootScope"]}(),function(){angular.module("app.filter",[])}(),function(){"use strict";function a(a){a.state("filter",{name:"filter",url:"/filter",controller:"Filter",controllerAs:"filter",templateUrl:"/static/filter/filter.html",data:{requiresLogin:!1}})}angular.module("app.filter").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b){this.ls=a,this.masterList=a.getMasterList,this.selectState=b}angular.module("app.filter").controller("Filter",a),a.$inject=["projectListService","selectStateService"]}(),function(){angular.module("app.header",["ui.router"])}(),function(){"use strict";function a(a,b,c,d){function e(){g.masterList().next>-1&&c.jumpToProject(g.masterList().next)}function f(){g.masterList().previous>-1&&c.jumpToProject(g.masterList().previous)}var g=this;this.currentUser=a.currentUser,this.masterList=c.getMasterList,this.getSql=c.getSql,this.loggedIn=d.loggedIn,this.login=d.login,this.logout=d.logout,this.jumpToNextProject=e,this.jumpToPreviousProject=f,a.$on("$stateChangeSuccess",function(a,b){function c(a){return b.name.split(".")[0]===a}function d(){return g.isActive("project")&&g.masterList().next>-1}function e(){return g.isActive("project")&&g.masterList().previous>-1}g.isActive=c,g.hasNext=d,g.hasPrevious=e})}angular.module("app.header").controller("Header",a),a.$inject=["$rootScope","$state","projectListService","loginStateService"]}(),function(){angular.module("app.login",["ui.bootstrap","angular-storage","angular-jwt"])}(),function(){"use strict";function a(a){function b(b,c){return a({url:"/auth",method:"POST",data:{username:b,password:c}})}var c={login:b};return c}angular.module("app.login").factory("loginApiService",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b){a.tokenGetter=function(a){return a.get("jwt")},b.interceptors.push("jwtInterceptor"),b.interceptors.push("loginInjector")}angular.module("app.login").config(a),a.$inject=["jwtInterceptorProvider","$httpProvider"]}(),function(){"use strict";function a(a,b){function c(c,d){b.login(c,d).then(function(b){a.$close(b)})}this.cancel=a.$dismiss,this.submit=c}angular.module("app.login").controller("Login",a),a.$inject=["$scope","loginApiService"]}(),function(){"use strict";function a(a,b,c,d,e){function f(a,f,g,h,i){var j=f.data&&f.data.requiresLogin,k=!c.get("jwt")||d.isTokenExpired(c.get("jwt"));j&&k&&(a.preventDefault(),e().then(function(){return b.go(f.name,g)},function(){return""==h.name?b.go("select"):void 0}))}b.transitionTo("select"),c.get("jwt")&&!d.isTokenExpired(c.get("jwt"))&&(a.currentUser=d.decodeToken(c.get("jwt"))),a.$on("$stateChangeStart",f)}angular.module("app.login").run(a),a.$inject=["$rootScope","$state","store","jwtHelper","loginService"]}(),function(){"use strict";function a(a,b,c,d){function e(){var b=a.open({templateUrl:"static/login/login.html",controller:"Login",controllerAs:"login"});return b.result.then(f)}function f(a){if(200==a.status){c.set("jwt",a.data.token);var e=d.decodeToken(a.data.token);return b.currentUser=e,e}return a}return e}angular.module("app.login").service("loginService",a),a.$inject=["$modal","$rootScope","store","jwtHelper"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){return n.loggedIn()?!0:!1}function g(){return n.loggedIn()&&_.intersection(a.currentUser.roles,n.can_edit_roles)?!0:!1}function h(b){return n.loggedIn()&&_.contains(a.currentUser.roles,b)?!0:!1}function i(){return Boolean(c.get("jwt"))}function j(){e()}function k(){c.remove("jwt"),delete a.currentUser}function l(){sessionStorage.loginStateService=angular.toJson(n.masterList)}function m(){n.masterList=angular.fromJson(sessionStorage.loginStateService)}var n={can_edit_roles:["Curator","Manager"],canAddComments:f,canEditProjects:g,hasRole:h,loggedIn:i,login:j,logout:k,SaveState:l,RestoreState:m};return n}angular.module("app.login").factory("loginStateService",a),a.$inject=["$rootScope","$http","store","jwtHelper","loginService"]}(),function(){angular.module("app.loginInjectorProvider",[])}(),function(){"use strict";function a(a,b,c){function d(b){if(401!==b.status)return b;var c=a.defer();return e().then(function(){c.resolve(f(b.config))},function(){g.go("select"),c.reject(b)}),c.promise}var e,f,g,h={responseError:d};return h}angular.module("app.loginInjectorProvider").factory("loginInjector",a),a.$inject=["$q","$injector","$timeout"]}(),function(){angular.module("app.manage",["ui.router"])}(),function(){"use strict";function a(a){a.state("manage",{url:"/manage",templateUrl:"/static/manage/manage.html",controller:"Manage",controllerAs:"manage",data:{requiresLogin:!0}})}angular.module("app.manage").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a){this.currentUser=a.currentUser}angular.module("app.manage").controller("Manage",a),a.$inject=["$rootScope"]}(),function(){angular.module("app.modalConfirm",["ui.bootstrap"])}(),function(){"use strict";function a(a){function b(b,c){var e={},f={};return jQuery.extend(e,d.modalDefaults,b),jQuery.extend(f,d.modalOptions,c),e.controller||(e.controller=["$scope","$modalInstance",function(a,b){a.modalOptions=f,a.modalOptions.ok=function(a){b.close(a)},a.modalOptions.close=function(a){b.dismiss("cancel")}}]),a.open(e).result}function c(a,b){return a||(a={}),a.backdrop="static",d.show(a,b)}var d={modalDefaults:{backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"/static/modalConfirm/confirm.html"},modalOptions:{actionText:"OK",bodyText:"OK to proceed?",closeText:"Close",headerText:"Confirm"},show:b,showModal:c};return d}angular.module("app.modalConfirm").factory("modalConfirmService",a),a.$inject=["$modal"]}(),function(){angular.module("app.project",["ui.date","ui.router"])}(),function(){"use strict";function a(a){a.state("project",{url:"/project",controller:"Project",controllerAs:"project",templateUrl:"/static/project/project.html",data:{requiresLogin:!1,viewUrl:"/static/project/project.html"},onEnter:["projectDataService",function(a){a.initService()}]}).state("project.add",{url:"/add",templateUrl:"/static/project/templates/description.html",data:{requiresLogin:!0}}).state("project.attach",{url:"/attach",data:{requiresLogin:!0}}).state("project.attach.edit",{url:"/edit/:projectID",controller:["$stateParams",function(a){console.log(a)}],controllerAs:"project",data:{requiresLogin:!0}}).state("project.comment",{url:"/comment",templateUrl:"/static/project/templates/comment.html",data:{requiresLogin:!0},resolve:{projectID:["$stateParams",function(a){return a.projectID}]}}).state("project.comment.add",{url:"/add/:projectID",controller:["$stateParams",function(a){console.log(a,projectID)}]}).state("project.comment.edit",{url:"/edit/:projectID",resolve:{projectID:["$stateParams",function(a){return a.projectID}]},controller:["$stateParams",function(a){console.log(a)}]}).state("project.comment.edit.detail",{url:"/detail/:commentID",controller:["$stateParams","projectID",function(a,b){a.projectID=b,console.log(a,b)}]}).state("project.description",{url:"/description",templateUrl:"/static/project/templates/description.html",data:{requiresLogin:!0}}).state("project.description.edit",{url:"/edit/:projectID",controller:["$stateParams",function(a){console.log(a)}],data:{requiresLogin:!0}}).state("project.detail",{url:"/:projectID",controller:["$stateParams",function(a){console.log(a)}],templateUrl:"/static/project/templates/detail.html",data:{requiresLogin:!1}}).state("project.disposition",{url:"/disposition",templateUrl:"/static/project/templates/disposition.html",data:{requiresLogin:!0}}).state("project.disposition.add",{url:"/add/:projectID",controller:["$stateParams",function(a){console.log(a)}]}).state("project.disposition.edit",{url:"/edit/:projectID",resolve:{projectID:["$stateParams",function(a){return a.projectID}]},controller:["$stateParams",function(a){console.log(a)}]}).state("project.disposition.edit.detail",{url:"/detail/:disposedInFY/:disposedInQ",controller:["$stateParams","projectID",function(a,b){console.log(a)}]}).state("project.portfolio",{url:"/portfolio",templateUrl:"/static/project/templates/portfolio.html",data:{requiresLogin:!0}}).state("project.portfolio.edit",{url:"/edit/:projectID",controller:["$stateParams",function(a){console.log(a)}]}).state("project.projectMan",{url:"/projectMan",templateUrl:"/static/project/templates/projectMan.html",data:{requiresLogin:!0}}).state("project.projectMan.edit",{url:"/edit/:projectID",controller:["$stateParams",function(a){console.log(a)}]})}angular.module("app.project").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){this.as=e,this.ds=c,this.ls=d,this.log_s=g,this.attributes=e.getAttributes,this.changeMode=c.changeMode,this.currentMode=c.currentMode,this.dateOptions={changeYear:!0,changeMonth:!0},this.jumpToAtachFile=c.jumpToAtachFile,this.jumpToAddForm=c.jumpToAddForm,this.masterList=this.ls.getMasterList,this.viewUrl=c.viewUrl,a.$on(["$stateChangeStart"],function(d,e,g,h,i){if(c.success="","undefined"!=typeof c.noCheck&&(a.projectForm.$setPristine(!0),delete c.noCheck),a.projectForm.$dirty){d.preventDefault();var j={closeText:"Cancel",actionText:"Continue",headerText:"Unsaved changes",bodyText:"You have unsaved changes. Press Continue to discard your changes and navigate away, or press Cancel to stay on this page."};f.showModal({},j).then(function(d){a.projectForm.$setPristine(!0);var f=g.projectID?g.projectID:i.projectID;c.getProjectData(f,g),b.go(e,g)})}})}angular.module("app.project").controller("Project",a),a.$inject=["$scope","$state","projectDataService","projectListService","attributesService","modalConfirmService","loginStateService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){c.go("select")}function k(a){a?c.go(a,{projectID:D.projectID}):c.go("project.detail",{projectID:D.projectID})}function l(){var a=f.getFormData("description",[]);b.get("getProjectAttributes/0").then(function(c){D.setProjectData(c),delete a.projectID;var d={method:"POST",url:"/projectCreate",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:jQuery.param(a,!0)};b(d).then(D.jumpToNewProject)})}function m(){return"project.detail"==c.current.name?"view":c.current.name.substring(8)}function n(){return c.current.name.indexOf("edit")>-1?!0:!1}function o(){return D.attributes}function p(a){parseInt(a.projectID)>-1&&b.get("getProjectAttributes/"+a.projectID).then(function(b){D.setProjectData(b,a)})}function q(){var a=i.getStateFromLocation();"projectID"in a.params&&a.params.projectID!=D.projectID&&(D.projectID=a.params.projectID,D.getProjectData(a.params),h.setProjectID(D.projectID))}function r(a,b){f.updateProjAttrsFromRawItem(a,b);g.canEditProjects()?c.go("project."+a+".edit",{projectID:c.params.projectID}):c.go("project.detail",{projectID:c.params.projectID})}function s(){h.hasProjects()||h.updateAllProjects();var a,b=h.getMasterList(),c=b.selectedIds;b.projectID;d.projectID?(a=d.projectID,h.setList(c),h.setDescription("projectID = "+a+";"),h.setSql({col_name:"projectID",val:a,op:"equals"})):(q(),D.projectID||h.hasProjects()&&(a=h.getProjectID())),d.projectID=a,D.projectID&&D.projectID==a||D.getProjectData(d)}function t(){c.go("project.attach",{projectID:D.projectID})}function u(a,b){f.updateProjAttrsFromRawItem(a,b),_.contains(["comment"],a)&&c.go("project."+a+".edit",{projectID:c.params.projectID}),c.go("project.add."+a,{projectID:c.params.projectID})}function v(a){D.setProjectData(a),h.updateAllProjects(a.data.projectID),c.go("project.description.edit",{projectID:a.data.projectID})}function w(){f.newProjectAttributes(),c.go("select.addProject")}function x(){"undefined"!=typeof sessionStorage.projectDataServiceAttributes&&(D.restoredParams=angular.fromJson(sessionStorage.projectDataServiceAttributes))}function y(a,d){var e=f.getFormData(a,d),g=(c.params.projectID?c.params.projectID:"",{method:"POST",url:"/projectEdit/"+c.params.projectID+"/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:jQuery.param(e,!0)});b(g).then(D.setProjectData),D.noCheck=!0,c.go("project."+a+".edit",{projectID:c.params.projectID,noCheck:!0})}function z(){sessionStorage.projectDataServiceAttributes=angular.toJson(d)}function A(a,b){f.updateProjectAttributes(a,b),D.projectID=a.data.projectID,D.success=a.data.success,D.SaveState(),f.SaveState()}function B(a,b){var d=f.updateProjAttrsFromRawItem(a,b);"comment"==a&&c.go("project.comment.edit.detail",{projectID:D.projectID,commentID:d.commentID}),"disposition"==a&&c.go("project.disposition.edit.detail",{projectID:D.projectID,disposedInFY:d.disposedInFY.id,disposedInQ:d.disposedInQ.id})}function C(){return Boolean(_.contains(projectForm.classList,"ng-pristine")&&D.success)}var D={attributes:f.getAllAttributes,cancelAddProject:j,changeMode:k,createProject:l,currentMode:m,editMode:n,getProjectData:p,getAttributes:o,getProjectAttributes:f.getProjectAttributes,getProjectDataFromLocation:q,hideDetails:r,initService:s,jumpToAtachFile:t,jumpToAddForm:u,jumpToNewProject:v,newProject:w,printValue:f.printValue,RestoreState:x,saveProject:y,SaveState:z,setProjectData:A,showDetails:B,showEditSuccess:C,stateParams:d,viewUrl:c.current.data?c.current.data.viewUrl:""};return D.RestoreState(),"undefined"==typeof D.getProjectAttributes()&&D.restoredParams&&D.getProjectData(D.restoredParams),a.$on("savestate",D.SaveState),a.$on("restorestate",D.RestoreState),D.SaveState(),D}angular.module("app.project").factory("projectDataService",a),a.$inject=["$rootScope","$http","$state","$stateParams","$location","attributesService","loginStateService","projectListService","stateLocationService"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){return z.getMasterList().allProjects.length}function g(a,b){if("undefined"==typeof b)var b=z.masterList.projectID;z.masterList.allProjects=a.data;var c=z.getIDListFromAllProjects();("undefined"==typeof b||0>b)&&(b=c[0]),y(b,c)}function h(){return _.map(z.masterList.allProjects,function(a){return a.projectID})}function i(){return z.masterList}function j(){return z.masterList.projectID}function k(){return z.masterList.selectedIds}function l(){return z.masterList.sql}function m(){return Boolean(z.allProjectsCount()>0)}function n(){z.masterList={allProjects:[],description:"",sql:"",index:-1,next:-1,previous:-1,projectID:-1,projectName:"",selectedIds:[]}}function o(a){a=parseInt(a);z.masterList.selectedIds.indexOf(a);if(z.masterList.selectedIds.indexOf(a)>-1)return void z.jumpToProjectInList(a,z.masterList.selectedIds);var b=z.getIDListFromAllProjects();return b.indexOf(a)>-1?void z.jumpToProjectInList(a,b):void alert("Can't find a project to display.")}function p(a,b){var d=b.indexOf(a);z.masterList.index=d,z.masterList.projectID=a,d>0?z.masterList.previous=b[d-1]:z.masterList.previous=-1,d<b.length?z.masterList.next=b[d+1]:z.masterList.next=-1;var e=z.getIDListFromAllProjects();d=e.indexOf(a),z.masterList.projectName=z.masterList.allProjects[d].name,c.go("project.detail",{projectID:a})}function q(){z.updateAllProjects(),z.setList(z.getIDListFromAllProjects()),z.setDescription("none"),z.setSql("")}function r(){z.masterList=angular.fromJson(sessionStorage.projectListService)}function s(){sessionStorage.projectListService=angular.toJson(z.masterList)}function t(){return z.masterList.selectedIds.length}function u(a){z.masterList.description=a}function v(a){z.masterList.selectedIds=a;var b=a.indexOf(z.masterList.projectID);if(0>b){var c=a[0];z.setProjectID(c,a)}}function w(a){z.masterList.sql=a}function x(a){b.post("/getBriefDescriptions").then(function(b){z.getAllProjectResults(b,a)})}function y(a,b){if(a){"undefined"==typeof b&&(b=z.masterList.selectedIds),z.masterList.projectID=a;var c=b.indexOf(a);c>-1&&(z.masterList.index=c,c>0?z.masterList.previous=b[c-1]:z.masterList.previous=-1,c<b.length?z.masterList.next=b[c+1]:z.masterList.next=-1,"undefined"==typeof z.masterList.selectedIds[0]&&(z.masterList.selectedIds=b)),_.each(z.masterList.allProjects,function(b){b.projectID==a&&(z.masterList.projectName=b.name)})}z.SaveState()}var z={allProjectsCount:f,getAllProjectResults:g,getIDListFromAllProjects:h,getMasterList:i,getProjectID:j,getSelectedIds:k,getSql:l,hasProjects:m,initModel:n,jumpToProject:o,jumpToProjectInList:p,resetList:q,RestoreState:r,SaveState:s,selectedIdsCount:t,setDescription:u,setList:v,setSql:w,updateAllProjects:x,setProjectID:y};return z.RestoreState(),"undefined"==typeof z.masterList&&z.initModel(),a.$on("savestate",z.SaveState),a.$on("restorestate",z.RestoreState),z}angular.module("app.project").factory("projectListService",a),a.$inject=["$rootScope","$http","$state","$stateParams","$location"]}(),function(){angular.module("app.report",["ui.router","datatables","datatables.bootstrap"])}(),function(){"use strict";function a(a){a.state("report",{url:"/report",controller:"Report",controllerAs:"report",templateUrl:"/static/report/report.html",data:{requiresLogin:!1}}).state("report.columns",{url:"/columns/:query_string",templateUrl:"/static/report/templates/columns.html",controller:["$stateParams",function(a){console.log(a)}]}).state("report.table",{url:"/:query_string",templateUrl:"/static/report/templates/table.html",controller:["$stateParams",function(a){console.log(a)}],onEnter:["reportTableService",function(a){a.initService()}]})}angular.module("app.report").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d){this.ls=c,this.masterList=this.ls.getMasterList,this.jumpToProject=this.ls.jumpToProject,this.ts=d,this.state=a}angular.module("app.report").controller("Report",a),a.$inject=["$state","$stateParams","projectListService","reportTableService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(b,c,d){a(angular.element(b).contents())(u.scope)}function k(a){var b={method:"POST",url:"/getReportResults",data:{query_string:encodeURIComponent(a),tableColumns:u.tableColumns()}};e(b).then(u.setReportResults)}function l(){var a={method:"POST",url:"/getReportTableJSON",data:{projectID:g.getSelectedIds(),tableColumns:u.tableColumns()}};e(a).then(u.setReportTableData)}function m(){g.hasProjects()||g.updateAllProjects();var a=i.query_string,b=g.getSql();a&&a!=b?u.getReportResults(a):!a&&b?u.getReportResults(b):""==a&&u.projectCount()!=g.allProjectsCount()?u.getReportResults(a):0==u.projectCount()&&u.getReportResults(a)}function n(a,b,c,d){return'<a ui-sref="project.detail({projectID: '+a+'})">'+a+"</a>"}function o(){try{return u.master.dtOptions.data.length}catch(a){return 0}}function p(){if("undefined"!=typeof sessionStorage.reportTableService){var a=angular.fromJson(sessionStorage.reportTableService);u.master.dtColumns=a.dtColumns,u.master.dtColumns[0]=u.projectIDColumn,u.master.dtOptions=a.dtOptions,u.master.dtOptions.createdRow=u.createdRow}}function q(){sessionStorage.reportTableService=angular.toJson(u.master)}function r(a){g.setList(a.data.projectList),g.setDescription(a.data.query_desc),g.setSql(a.data.query_string),g.SaveState(),s(a),u.master.dtInstance.rerender(),u.SaveState()}function s(a){u.master.dtOptions=d.newOptions().withBootstrap(),_.each(Object.keys(a.data.options),function(b){u.master.dtOptions.withOption(b,a.data.options[b])}),u.master.dtOptions.withOption("createdRow",j),u.master.dtColumns=[u.projectIDColumn].concat(a.data.columns),u.master.dtOptions.data=a.data.data;var b=f.path().split("/");b.pop(),b.push(a.data.query_string),u.SaveState()}function t(){return _.pluck(u.master.dtColumns,"data")}var u={createdRow:j,projectCount:o,getReportResults:k,getReportTableData:l,initService:m,projectIDColumn:{data:"projectID",title:"ID",render:n,defaultContent:""},RestoreState:p,SaveState:q,scope:h.$new(),setReportResults:r,setReportTableData:s,tableColumns:t,master:{dtColumns:[{data:"projectID",title:"ID",render:n,defaultContent:""},{data:"name",title:"Name"},{data:"description",title:"Description"},{data:"maturityID",title:"Maturity"},{data:"driverID",title:"Driver"}],dtInstance:{},dtOptions:{}}};return u.RestoreState(),h.$on("savestate",u.SaveState),h.$on("restorestate",u.RestoreState),u.SaveState(),u}angular.module("app.report").factory("reportTableService",a),a.$inject=["$compile","DTColumnBuilder","DTInstances","DTOptionsBuilder","$http","$location","projectListService","$rootScope","$stateParams"]}(),function(){angular.module("app.select",["ui.router","readMore"])}(),function(){"use strict";function a(a){a.state("select",{url:"/select",controller:"Select",controllerAs:"select",templateUrl:"/static/select/select.html",data:{requiresLogin:!1},onEnter:["selectStateService",function(a){a.initService()}]}).state("select.addProject",{url:"/addProject",controller:"Select",controllerAs:"select",data:{requiresLogin:!0}})}angular.module("app.select").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f){this.state=b,this.ls=c,this.masterList=this.ls.getMasterList,this.jumpToProject=this.ls.jumpToProject,this.ss=d,this.selectState=d.getMasterList,this.ds=e,a.$on("$stateChangeStart",function(c,d,g,h,i){if(e.success="",a.addProject.$dirty){c.preventDefault();var j={closeText:"Cancel",actionText:"Continue",headerText:"Unsaved changes",bodyText:"You have unsaved changes. Press Continue to discard your changes and navigate away, or press Cancel to stay on this page."};f.showModal({},j).then(function(c){a.addProject.$setPristine(),b.go(d,g)})}})}angular.module("app.select").controller("Select",a),a.$inject=["$scope","$state","projectListService","selectStateService","projectDataService","modalConfirmService"]}(),function(){"use strict";function a(){return function(a,b,c,d){if(!b)return a;var e=(a.length||0,(b||"").toLowerCase()),f=e.split(" "),g=(f.length,a);if("0"==d&&(g=_.filter(g,function(a){return"0"==a.finalID})),"phrase"==c)g=_.filter(g,function(a){return(a.name+" "+a.description).toLowerCase().match(e)});else if("and"==c)_.map(f,function(a){g=_.filter(g,function(a){return(a.name+" "+a.description).toLowerCase().match(this)},a)});else if("or"==c){var h,i=[];_.map(f,function(a){h=_.filter(g,function(a){return(a.name+" "+a.description).toLowerCase().match(this)},a),i=_.union(h,i)}),g=_.intersection(g,i)}return g}}angular.module("app.select").filter("nameSearch",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){t.masterList.breakdownAttr=""}function g(){t.masterList.searchText=""}function h(){return t.breakdownByAttribute}function i(){return t.breakdownChoicesList}function j(){var a=0;return _.each(t.breakdownByAttribute,function(b){a+=b.projectList.length}),a}function k(){return t.masterList}function l(){d.resetList()}function m(a){d.setList(a.projectList),d.setDescription(a.query_desc),d.setSql(a.query_string),d.SaveState(),c.go("report.table",{query_string:a.query_string})}function n(){"undefined"!=typeof sessionStorage.selectStateService&&(t.masterList=angular.fromJson(sessionStorage.selectStateService))}function o(){sessionStorage.selectStateService=angular.toJson(t.masterList)}function p(a){t.breakdownByAttribute=a.data}function q(a){t.breakdownChoicesList=a.data,t.SaveState()}function r(){b.get("getBreakdownByAttribute/"+t.masterList.breakdownAttr.id).then(p)}function s(){b.get("getBreakdownChoices").then(q)}var t={masterList:{searchText:"",nameLogic:"or",finalID:"0",breakdownAttr:null},clearBreakdown:f,clearSearchText:g,getBreakdownByAttribute:h,getBreakdownChoices:i,getBreakdownTotal:j,getMasterList:k,initService:l,jumpToBreakdownTable:m,setBreakdownChoices:q,updateBreakdownByAttribute:r,updateBreakdownChoices:s,SaveState:o,RestoreState:n};return n(),"undefined"==typeof t.breakdownChoicesList&&t.updateBreakdownChoices(),a.$on("savestate, service.SaveState"),a.$on("restorestate, service.RestoreState"),o(),t}angular.module("app.select").factory("selectStateService",a),a.$inject=["$rootScope","$http","$state","projectListService","reportTableService"]}(),function(){angular.module("app.stateLocation",["ui.router"])}(),function(){"use strict";function a(){function a(a,b){var c=void 0===b?null:JSON.stringify(b);return sessionStorage.setItem(a,c)}function b(a){return JSON.parse(sessionStorage.getItem(a))}function c(){var a=[];for(key in sessionStorage)a.push(f.setStorage(key,null));return a}function d(a){return null==a&&(a=null),f.accessor("stateHistory",a)}function e(a,b){return null==b?f.getStorage(a):f.setStorage(a,b)}var f={setStorage:a,getStorage:b,clear:c,stateHistory:d,accessor:e};return f}angular.module("app.stateLocation").factory("sessionService",a)}(),function(){"use strict";function a(a){function b(b,c){var d=a.stateHistory(),e=null!=d?d:{};return e[b]=c,a.stateHistory(e)}function c(b){var c=a.stateHistory();
return null!=c?c[b]:void 0}var d={set:b,get:c};return d}angular.module("app.stateLocation").factory("stateHistoryService",a),a.$inject=["sessionService"]}(),function(){"use strict";function a(a,b,c){a.$on("$stateChangeSuccess",function(a,b,d){c.stateChange()}),a.$on("$locationChangeSuccess",function(){c.locationChange()})}angular.module("app.stateLocation").run(a),a.$inject=["$rootScope","$state","stateLocationService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){return angular.fromJson(sessionStorage.currentState)}function i(){if(null==q.preventCall.pop("locationChange")){var a=b.url(),d=f.get(a);null!=d&&("projectID"in d.params&&g.setProjectID(d.params.projectID),q.preventCall.push("stateChange"),c.go(d.name,d.params,{location:!1}))}}function j(){var a=new Object;a.params=new Object;var c=b.path().split("/").reverse();c.pop();var d=c.pop();if("project"==d){"comment"==_.last(c)&&"detail"==c[1]?(a.name="project.comment.edit.detail",a.params.commentID=parseInt(c[0]),a.params.projectID=parseInt(c[2])):"disposition"==_.last(c)&&"detail"==c[2]?(a.name="project.disposition.edit.detail",a.params.projectID=parseInt(c[3]),a.params.disposedInFY=parseInt(c(1)),a.params.disposedInQ=parseInt(c(0))):1==c.length?(a.name="project.detail",a.params.projectID=parseInt(c[0])):(a.name=["project",c[2],c[1]].join("."),a.params.projectID=parseInt(c[0]))}else"report"==d?"columns"==c[1]?(a.name="report.columns",a.params.query_string=c[0]):(a.name="report.table",a.params.query_string=c[0]):a.name=[d].concat(c).join(".");return a}function k(){if(null==q.preventCall.pop("stateChange")&&c.current.name){var a=l(),e={name:c.current.name,params:d};f.set(a,e),q.preventCall.push("locationChange"),b.url(a)}}function l(){var a=c.href(c.current,c.params);"#"==a[0]&&(a=a.substring(1));var d=q.guid().substr(0,8),e=_.first(c.current.name.split("."));return"project"==e?a=b.hash(d):"report"==e&&(a=b.hash(d)),"object"==typeof a?a.url():"string"==typeof a?a:void 0}function m(){if(c.current.name){var a={name:c.current.name,params:c.params};sessionStorage.currentState=angular.toJson(a)}}function n(){if(c.current.name){var a={name:c.current.name,params:c.params},d=b.url();f.set(d,a)}}function o(){return""+q.s4()+q.s4()+"-"+q.s4()+"-"+q.s4()+"-"+q.s4()+"-"+q.s4()+q.s4()+q.s4()}function p(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var q={preventCall:[],locationChange:i,getCurrentState:h,getStateFromLocation:j,saveState:n,stateChange:k,saveCurrentState:m,guid:o,s4:p};return window.onbeforeunload=function(b){a.$broadcast("savestate")},q}angular.module("app.stateLocation").factory("stateLocationService",a),a.$inject=["$rootScope","$location","$state","$stateParams","$urlMatcherFactory","stateHistoryService","projectListService"]}(),function(){angular.module("app.title",["ui.router"])}(),function(){"use strict";function a(a,b,c){var d=this;this.masterList=c.getMasterList,this.pageTitle="PPT: Select",a.$on("$stateChangeSuccess",function(a,b){"select"==b.name.split(".")[0]?d.pageTitle="PPT: Select":"filter"==b.name.split(".")[0]?d.pageTitle="PPT: Filter Builder":"report"==b.name.split(".")[0]?d.pageTitle="PPT: Report":"project"==b.name.split(".")[0]?d.pageTitle=d.masterList().projectID+". "+d.masterList().projectName:"comment"==b.name.split(".")[0]?d.pageTitle="PPT: Comments":"curate"==b.name.split(".")[0]?d.pageTitle="PPT: Curate":"manage"==b.name.split(".")[0]?d.pageTitle="PPT: Manage":d.pageTitle="PPT: Select"})}angular.module("app.title").controller("Title",a),a.$inject=["$scope","$state","projectListService"]}();